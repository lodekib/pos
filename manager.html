<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <link href="dist/output.css" type="text/css" rel="stylesheet">
  <title>Splash Car Wash</title>
</head>

<body">
  <div class="flex flex-row min-h-screen bg-gray-100 text-gray-800">
    <aside
      class="sidebar w-64 md:shadow transform -translate-x-full md:translate-x-0 transition-transform duration-150 ease-in bg-amber-800">
      <div class="sidebar-header flex items-center justify-center py-4">
        <div class="inline-flex">
          <a href="#" class="inline-flex flex-row items-center">
            <img src="./assets/splash.png">
          </a>
        </div>
      </div>
      <div class="sidebar-content px-4 py-6">
        <ul class="flex flex-col w-full">
          <li class="my-px">
            <a href="#" class="flex flex-row items-center h-10 px-3 rounded-lg text-gray-700 bg-gray-100">
              <span class="flex items-center justify-center text-lg text-gray-400">
                <svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
                  stroke="currentColor" class="h-6 w-6">
                  <path
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
              </span>
              <span class="ml-3">Dashboard</span>
            </a>
          </li>
          <li class="my-px">
            <span class="flex font-medium text-sm text-gray-300 px-4 my-4 uppercase">Transactions</span>
          </li>
          <li class="my-px">
            <a href="#" id="transaction"
              class="flex flex-row items-center h-10 px-3 rounded-lg text-gray-300 hover:bg-gray-100 hover:text-gray-700">
              <span class="flex items-center justify-center text-lg text-green-400">
                <svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
                  stroke="currentColor" class="h-6 w-6">
                  <path d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </span>
              <span class="ml-3">Add new transaction</span>
            </a>
          </li>
          <li class="my-px">
            <span class="flex font-medium text-sm text-gray-300 px-4 my-4 uppercase">Clients</span>
          </li>
          <li class="my-px">
            <a href="#" id="reward"
              class="flex flex-row items-center h-10 px-3 rounded-lg text-gray-300 hover:bg-gray-100 hover:text-gray-700">
              <span class="flex items-center justify-center text-lg text-green-400">
                <svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
                  stroke="currentColor" class="h-6 w-6">
                  <path d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </span>
              <span class="ml-3">Reward Client</span>
            </a>
          </li>
          <li class="my-px">
            <a href="#" id="clients"
              class="flex flex-row items-center h-10 px-3 rounded-lg text-gray-300 hover:bg-gray-100 hover:text-gray-700">
              <span class="flex items-center justify-center text-lg text-gray-400">
                <svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
                  stroke="currentColor" class="h-6 w-6">
                  <path
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                </svg>
              </span>
              <span class="ml-3">Clients</span>
            </a>
          </li>
          <li class="my-px">
            <span class="flex font-medium text-sm text-gray-300 px-4 my-4 uppercase">Account</span>
          </li>
          <!-- <li class="my-px">
            <a href="#" id="profile"
              class="flex flex-row items-center h-10 px-3 rounded-lg text-gray-300 hover:bg-gray-100 hover:text-gray-700">
              <span class="flex items-center justify-center text-lg text-gray-400">
                <svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
                  stroke="currentColor" class="h-6 w-6">
                  <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
              </span>
              <span class="ml-3">Profile</span>
            </a>
          </li> -->


          <li class="my-px">
            <a href="#" id="logout"
              class="flex flex-row items-center h-10 px-3 rounded-lg text-gray-300 hover:bg-gray-100 hover:text-gray-700">
              <span class="flex items-center justify-center text-lg text-red-400">
                <svg fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
                  stroke="currentColor" class="h-6 w-6">
                  <path
                    d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z" />
                </svg>
              </span>
              <span class="ml-3">Logout</span>
            </a>
          </li>
        </ul>
      </div>
    </aside>
    <main class="main flex flex-col flex-grow -ml-64 md:ml-0 transition-all duration-150 ease-in">
      <header class="header bg-white shadow py-4 px-4">
        <div class="header-content flex items-center flex-row">
          <form action="#">

            <div class="flex md:hidden">
              <a href="#" class="flex items-center justify-center h-10 w-10 border-transparent">
                <svg class="h-6 w-6 text-gray-500" fill="none" stroke-linecap="round" stroke-linejoin="round"
                  stroke-width="2" viewBox="0 0 24 24" stroke="currentColor">
                  <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
              </a>
            </div>
          </form>
          <div class="flex ml-auto">
            <a href class="flex flex-row items-center">
              <img src="./assets/splash.png" alt class="h-10 w-10 bg-gray-200 border rounded-full" />
              <span class="flex flex-col ml-2">
                <span id="manager" class="truncate w-20 font-semibold tracking-wide leading-none"></span>
                <span class="truncate w-20 text-gray-500 text-xs leading-none mt-1">Manager</span>
              </span>
            </a>
          </div>
        </div>
      </header>
      <h3 class="text-amber-800 py-2 px-6 mx-3 my-2">New Transaction</h3>

      <div class="main-content flex flex-col flex-grow p-4">
        <div class="flex flex-col flex-grow  bg-transparent rounded mt-4">
          <div class="md:flex md:justify-center mb-6">
            <form class="py-5">
              <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="first_name">
                    Client First Name
                  </label>
                  <input
                    class="appearance-none block w-full bg-gray-200 text-gray-700 border  rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"
                    id="first_name" name="first_name" type="text">
                </div>
                <div class="w-full md:w-1/2 px-3">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="last_name">
                    Client Last Name
                  </label>
                  <input
                    class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                    id="last_name" name="last_name" type="text">
                </div>
              </div>
              <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="number_plate">
                    Client Car Plate
                  </label>
                  <input
                    class="appearance-none block w-full bg-gray-200 text-gray-700 border  rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"
                    id="number_plate" name="number_plate" type="text">
                </div>

                <div class="w-full md:w-1/2 px-3">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="served_by">
                    Served By
                  </label>
                  <select
                    class="block appearance-none w-full bg-gray-200 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                    id="served_by" name="served_by">
                  </select>
                  <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                      <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                    </svg>
                  </div>
                </div>
              </div>

              <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full px-3">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="car-type">
                    Car Type
                  </label>
                  <div class="relative">
                    <select
                      class="block appearance-none w-full bg-gray-200 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                      id="car_type" name="car_type">
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                      <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full px-3">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="service_type">
                    Service Type
                  </label>
                  <div class="relative">
                    <select
                      class="block appearance-none w-full bg-gray-200 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                      id="service_type" name="service_type">
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                      <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                      </svg>
                    </div>
                  </div>
                </div>
              </div>

              <div class="flex flex-wrap -mx-3 mb-6">
                <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="amount">
                    Amount
                  </label>
                  <input
                    class="appearance-none block w-full bg-gray-200 text-gray-700 border  rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"
                    id="amount" name="amount" type="number">
                </div>
                <div class="w-full md:w-1/2 px-3">
                  <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="date">
                    Date
                  </label>
                  <input
                    class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500"
                    id="date" name="date" type="datetime-local" placeholder="Doe">
                </div>
              </div>

              <button id="receipt" class="bg-amber-800 hover:bg-gray-300 text-white font-bold py-2 px-4 rounded">
                Print Receipt
              </button>
            </form>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    let $ = require('jquery')
    let ipc = require('electron').ipcRenderer
    let index = 0
    let sum = 0
    ipc.on('login_success', (event, args) => {
      $('#manager').innerHTML = args
    })
    ipc.on('no_revenue', (event, args) => {
      let rev = document.querySelector('#rev')
      rev.innerHTML = 0
    })
    ipc.send('revenue')
    ipc.on('all_revenue', (event, args) => {
      let rev = document.querySelector('#rev')
      for (let i = 0; i < args.length; i++) {
        sum += args[i].amount
      }
      rev.innerHTML = 'Ksh ' + sum
    })

    ipc.send('all_expenses')
    ipc.on('allexpenses', (event, args) => {
      exp.innerHTML = 'Ksh ' + args
    })
    ipc.send('all_employees')
    ipc.on('allemployees', (event, args) => {
      document.querySelector("#emp").innerHTML = args.length
    })

    ipc.send('table_data')
    ipc.on('all_transactions', (event, args) => {
      let tbody = $('#tbody')
      for (let i = 0; i < args.length; i++) {
        let tr = document.createElement('tr')
        let td_id = document.createElement('td')
        let td_name = document.createElement('td')
        let td_plate = document.createElement('td')
        let td_type = document.createElement('td')
        let td_service = document.createElement("td")
        let td_served = document.createElement("td")
        let td_payment = document.createElement("td")
        let td_date = document.createElement("td")


        tr.classList.add("bg-gray-100", "border-b")
        td_id.classList.add("px-6", "py-4", "whitespace-nowrap", "text-sm", "font-medium", "text-gray-900")
        td_name.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")
        td_plate.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")
        td_type.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")
        td_service.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")
        td_served.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")
        td_payment.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")
        td_date.classList.add("text-sm", "text-gray-900", "font-light", "px-6", "py-4", "whitespace-nowrap")

        td_id.innerHTML = index++
        td_name.innerHTML = args[i].client_firstname + ' ' + args[i].client_lastname
        td_plate.innerHTML = args[i].car_plate
        td_type.innerHTML = args[i].client_car_type
        td_service.innerHTML = args[i].service_offered
        td_served.innerHTML = args[i].service_employee
        td_payment.innerHTML = args[i].amount
        td_date.innerHTML = args[i].date

        tr.append(td_id, td_name, td_plate, td_type, td_service, td_served, td_payment, td_date)
        tbody.append(tr)
      }


    })
    $('#add_service').on('click', () => {
      ipc.send('add_service')
    })

    $('#transaction').on('click', () => {
      ipc.send('transaction')
    })
    $('#rollback').on('click', () => {
      ipc.send('rollback')
    })
    $('#expenditure').on('click', () => {
      ipc.send('expenditure')
    })
    $('#services').on('click', () => {
      ipc.send('services')
    })
    $('#concerns').on('click', () => {
      ipc.send('concerns')
    })
    $('#updatesalary').on('click', () => {
      ipc.send('updatesalary')
    })
    $('#employees').on('click', () => {
      ipc.send('employees')
    })
    $('#newemployee').on('click', () => {
      ipc.send('newemployee')
    })
    // $('#profile').on('click', () => {
    //   ipc.send('profile')
    // })
    // $('#settings').on('click', () => {
    //   ipc.send('settings')
    // })
    $('#reports').on('click', () => {
      ipc.send('reports')
    })
    $('#reward').on('click', () => {
      ipc.send('reward')
    })
    $('#clients').on('click', () => {
      ipc.send('clients')
    })
    $('#logout').on('click', () => {
      ipc.send('logout')
    })

    $('#expense_tap').on('click', () => {
      ipc.send('expenses_tap')
    })


    ipc.on('error_addtransaction', (event, args) => {
      window.alert(args)
    })
    ipc.on('success_addtransaction', (event, args) => {
      window.alert(args)
    })
    ipc.send('employee_lastname_report')
    ipc.on('employeelastnamereport', (event, args) => {
      let select = $('#served_by')
      for (let i = 0; i < args.length; i++) {
        let option = document.createElement('option')
        option.value = args[i].last_name
        option.text = args[i].last_name
        select.append(option)
      }
    })


    $('#receipt').on('click', () => {
      var c_firstname = $('#first_name').val().trim()
      var c_lastname = $('#last_name').val().trim()
      var number_plate = $('#number_plate').val().trim()
      var served_by = $('#served_by').val().trim()
      var car_type = $('#car_type').val().trim()
      var service_type = $('#service_type').val().trim()
      var amount = $('#amount').val().trim()
      var date = $('#date').val().trim()
      if (!c_lastname == '' && !c_firstname == '' && !number_plate == '' && !served_by == '' && !car_type == '' && !service_type == '' && !amount == '' && !date == '') {
        ipc.send('receipt', [c_firstname, c_lastname, number_plate, served_by, car_type, service_type, amount, date])

      } else {
        window.alert('Please provide missing fields')
      }
    })

    ipc.send('transaction_services')
    ipc.on('success_allservices', (event, args) => {
      let select = $('#service_type')
      for (let i = 0; i < args.length; i++) {
        let option = document.createElement('option')
        option.value = args[i].service_name
        option.innerHTML = args[i].service_name
        select.append(option)
      }
    })
    ipc.on('error_alltransactions', (event, args) => {
      window.alert(args)
    })

    ipc.send('transaction_cars')
    ipc.on('success_allcars', (event, args) => {
      let select = $('#car_type')
      for (let i = 1; i < args.length; i++) {
        let option = document.createElement('option')
        let val = args[i].name.replace('_', ' ')
        option.value = val
        option.innerHTML = val
        select.append(option)
      }
    })

    ipc.on('error_allcars', (event, args) => {
      window.alert(args)
    })




  </script>
  </body>

</html>